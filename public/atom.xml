<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Zhangshengshan&#39;s Blog</title>
  <subtitle>Blogs on machine learning for my baby Ruru</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://zhangshengshan.github.io/"/>
  <updated>2017-01-04T15:35:43.000Z</updated>
  <id>http://zhangshengshan.github.io/</id>
  
  <author>
    <name>Zhang ShengShan</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Deep MNIST for Experts</title>
    <link href="http://zhangshengshan.github.io/2017/01/04/Deep-MNIST-for-Experts/"/>
    <id>http://zhangshengshan.github.io/2017/01/04/Deep-MNIST-for-Experts/</id>
    <published>2017-01-04T15:30:16.000Z</published>
    <updated>2017-01-04T15:35:43.000Z</updated>
    
    <content type="html">&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;from tensorflow.examples.tutorials.mnist import input_data&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mnist = input_data.read_data_sets(&amp;apos;MNIST_data&amp;apos;, one_hot=True)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import tensorflow as tf&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sess = tf.InteractiveSession()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#None 表示这里可能存在很多个样本, 784=28*28表示共有784个像素点&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#y_表示与x对应的label, 由于采用的是one_hot编码的所以是10维&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;x = tf.placeholder(tf.float32, shape=[None, 784])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;y_ = tf.placeholder(tf.float32, shape=[None, 10])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;W = tf.Variable(tf.zeros([784,10]))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;b = tf.Variable(tf.zeros([10]))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sess.run(tf.global_variables_initializer())&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# 假设 有X个样本，那么 (X*784) * (784*10) = (X*10) &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;y = tf.matmul(x,W) + b&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cross_entropy = tf.reduce_mean(tf.nn.softmax_cross_entropy_with_logits(y, y_))&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class
    
    </summary>
    
    
      <category term="tensorflow" scheme="http://zhangshengshan.github.io/tags/tensorflow/"/>
    
  </entry>
  
  <entry>
    <title>Google 面试宝典</title>
    <link href="http://zhangshengshan.github.io/2017/01/04/Google-%E9%9D%A2%E8%AF%95%E5%AE%9D%E5%85%B8/"/>
    <id>http://zhangshengshan.github.io/2017/01/04/Google-面试宝典/</id>
    <published>2017-01-04T11:13:16.000Z</published>
    <updated>2017-01-04T11:15:06.000Z</updated>
    
    <content type="html">&lt;p&gt;geek.csdn.net/news/detail/107064&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;geek.csdn.net/news/detail/107064&lt;/p&gt;

    
    </summary>
    
    
      <category term="基础" scheme="http://zhangshengshan.github.io/tags/%E5%9F%BA%E7%A1%80/"/>
    
  </entry>
  
  <entry>
    <title>install tensorflow</title>
    <link href="http://zhangshengshan.github.io/2016/12/28/install-tensorflow/"/>
    <id>http://zhangshengshan.github.io/2016/12/28/install-tensorflow/</id>
    <published>2016-12-28T07:04:08.000Z</published>
    <updated>2016-12-28T07:10:37.000Z</updated>
    
    <content type="html">&lt;p&gt;anaconda 提供了python科学计算的环境，为各种python软件包安装和管理提供了遍历，按照官方文档的方式即可以安装tensorflow. &lt;/p&gt;
&lt;h2 id=&quot;创建tensorflow的虚拟环境&quot;&gt;&lt;a href=&quot;#创建tensorflow的虚拟环境&quot; class=&quot;headerlink&quot; title=&quot;创建tensorflow的虚拟环境&quot;&gt;&lt;/a&gt;创建tensorflow的虚拟环境&lt;/h2&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;conda create -n tensorflow python=3.5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;安装tensorflow&quot;&gt;&lt;a href=&quot;#安装tensorflow&quot; class=&quot;headerlink&quot; title=&quot;安装tensorflow&quot;&gt;&lt;/a&gt;安装tensorflow&lt;/h2&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ source activate tensorflow&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;(tensorflow)$  # Your prompt should change&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# Linux/Mac OS X, Python 2.7/3.4/3.5, CPU only:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;(tensorflow)$ conda install -c conda-forge tensorflow&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;如果网络状况不好，那么可以采用pip安装。&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ source activate tensorflow&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;(tensorflow)$  # Your prompt should change&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;export TF_BINARY_URL=https://storage.googleapis.com/tensorflow/mac/cpu/tensorflow-0.12.0-py3-none-any.whl&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;请注意这里不能采用pip3安装，因为anaconda环境中pip3安装是有问题的&lt;/strong&gt;&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;pip install --ignore-installed --upgrade $TF_BINARY_URL&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;测试是否安装成功&quot;&gt;&lt;a href=&quot;#测试是否安装成功&quot; class=&quot;headerlink&quot; title=&quot;测试是否安装成功&quot;&gt;&lt;/a&gt;测试是否安装成功&lt;/h2&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;import tensorflow as tf&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;print(tf.__versioin__)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;anaconda 提供了python科学计算的环境，为各种python软件包安装和管理提供了遍历，按照官方文档的方式即可以安装tensorflow. &lt;/p&gt;
&lt;h2 id=&quot;创建tensorflow的虚拟环境&quot;&gt;&lt;a href=&quot;#创建tensorflow的虚拟环境&quot; c
    
    </summary>
    
    
      <category term="tensorflow" scheme="http://zhangshengshan.github.io/tags/tensorflow/"/>
    
  </entry>
  
  <entry>
    <title>vim使用技巧</title>
    <link href="http://zhangshengshan.github.io/2016/12/22/vim%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7/"/>
    <id>http://zhangshengshan.github.io/2016/12/22/vim使用技巧/</id>
    <published>2016-12-21T16:10:50.000Z</published>
    <updated>2016-12-21T16:15:16.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;dbext&quot;&gt;&lt;a href=&quot;#dbext&quot; class=&quot;headerlink&quot; title=&quot;dbext&quot;&gt;&lt;/a&gt;dbext&lt;/h2&gt;&lt;p&gt;在命令式中输入如下指令，比如DBCompleteTables可以在vim的dictionary中存储当前数据库的表格名称。&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;DBCompleteTables&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;DBCompleteProcedures&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;DBCompleteViews&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;此时在vim中输入表格名称时候可以通过ctrl+x 和 ctrl+k 来实现自动不全表名称的功能。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;dbext&quot;&gt;&lt;a href=&quot;#dbext&quot; class=&quot;headerlink&quot; title=&quot;dbext&quot;&gt;&lt;/a&gt;dbext&lt;/h2&gt;&lt;p&gt;在命令式中输入如下指令，比如DBCompleteTables可以在vim的dictionary中存储当前数据库的表格
    
    </summary>
    
    
      <category term="VIM" scheme="http://zhangshengshan.github.io/tags/VIM/"/>
    
  </entry>
  
  <entry>
    <title>UVa455</title>
    <link href="http://zhangshengshan.github.io/2016/12/21/UVa455/"/>
    <id>http://zhangshengshan.github.io/2016/12/21/UVa455/</id>
    <published>2016-12-21T15:44:56.000Z</published>
    <updated>2016-12-21T15:46:15.000Z</updated>
    
    <content type="html">&lt;p&gt;inspired by my wife, and i got the code below&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;#include &amp;lt;stdlib.h&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#include &amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#include &amp;lt;strings.h&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;int main ( int argc, char *argv[] )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    char buf[81];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    int i = 0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    memset(buf,0,sizeof(buf));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    while(scanf(&amp;quot;%s&amp;quot;,buf)!=EOF)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        for(i=1;i&amp;lt;strlen(buf);i++)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            if ( strlen(buf)%i==0 )&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                if (strncmp(buf,buf+i,strlen(buf)-i)==0) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    printf ( &amp;quot; k is %d\n&amp;quot;,i );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    break;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        if(i==strlen(buf))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            printf ( &amp;quot;k is %d\n&amp;quot;,i );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        memset(buf,0,sizeof(buf));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    return EXIT_SUCCESS;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;inspired by my wife, and i got the code below&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;
    
    </summary>
    
    
      <category term="竞赛" scheme="http://zhangshengshan.github.io/tags/%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>UVa1225</title>
    <link href="http://zhangshengshan.github.io/2016/12/21/UVa1225/"/>
    <id>http://zhangshengshan.github.io/2016/12/21/UVa1225/</id>
    <published>2016-12-21T14:37:52.000Z</published>
    <updated>2016-12-21T14:38:38.000Z</updated>
    
    <content type="html">&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;#include &amp;lt;stdlib.h&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#include &amp;lt;stdlib.h&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#include &amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#include &amp;lt;strings.h&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;int main ( int argc, char *argv[] )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    int a[10]=&amp;#123;0&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    int temp = 0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    int i =0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    int num=0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    while(1==scanf(&amp;quot;%d&amp;quot;,&amp;amp;num))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        memset(a,0,sizeof(a));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        for (i = 1; i &amp;lt;= num; i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            temp = i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            do &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                a[temp%10]++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                temp = temp/10;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125; while(temp);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        for (i = 0; i &amp;lt; 9; i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            printf ( &amp;quot;%d &amp;quot;,a[i] );           /* code */&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        printf ( &amp;quot;%d\n&amp;quot;, a[i] );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    return EXIT_SUCCESS;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;				/* ----------  end of function main  ---------- */&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class
    
    </summary>
    
    
      <category term="竞赛" scheme="http://zhangshengshan.github.io/tags/%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>3_2UVa1586</title>
    <link href="http://zhangshengshan.github.io/2016/12/21/3-2UVa1586/"/>
    <id>http://zhangshengshan.github.io/2016/12/21/3-2UVa1586/</id>
    <published>2016-12-20T16:11:06.000Z</published>
    <updated>2016-12-20T16:28:03.000Z</updated>
    
    <content type="html">&lt;h1 id=&quot;Molar-Mass-ACM-ICPC-sroul-2007-UVa1586&quot;&gt;&lt;a href=&quot;#Molar-Mass-ACM-ICPC-sroul-2007-UVa1586&quot; class=&quot;headerlink&quot; title=&quot;Molar Mass ACM/ICPC sroul 2007, UVa1586&quot;&gt;&lt;/a&gt;Molar Mass ACM/ICPC sroul 2007, UVa1586&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;#include &amp;lt;stdlib.h&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#include &amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#include &amp;lt;strings.h&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#include &amp;lt;ctype.h&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/* &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * ===  FUNCTION  ======================================================================&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; *         Name:  main&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; *  Description:  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * =====================================================================================&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; */&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/* &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * ===  FUNCTION  ======================================================================&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; *         Name:  get_g&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; *  Description:  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * =====================================================================================&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; */&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;float get_g ( char a )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    switch(a)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        case &amp;apos;C&amp;apos;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            return 12.01;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            break;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        case &amp;apos;H&amp;apos;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            return 1.008;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            break;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        case &amp;apos;O&amp;apos;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            return 16.00;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            break;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        case &amp;apos;N&amp;apos;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            return 14.01;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            break;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        default:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            return -1.0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;		&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;int main ( int argc, char *argv[] ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    char buf[101]=&amp;#123;&amp;#125;; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    int flag = 0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    float sum = 0.0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    int i = 0 ;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    int j = 0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    int count = 0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    while( (scanf(&amp;quot;%s&amp;quot;, buf)!=EOF) )&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        flag = 0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        for (i = 0; buf[i]!=&amp;apos;\0&amp;apos;; i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            count = 0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            for( j=i+1;isdigit(buf[j])&amp;amp;&amp;amp;buf[j];j++ )&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                count = count * 10 + (buf[j]-&amp;apos;0&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            if (count==0) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                count=1;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            if (buf[i]!=&amp;apos;C&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;amp;&amp;amp; buf[i]!=&amp;apos;N&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;amp;&amp;amp; buf[i]!=&amp;apos;O&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;amp;&amp;amp; buf[i]!=&amp;apos;H&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                flag = 1;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            sum += count * get_g(buf[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            i=j-1;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        if (!flag)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            printf ( &amp;quot;sum is %f\n&amp;quot;,sum );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;else&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//            printf ( &amp;quot;input error\n&amp;quot; );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    return EXIT_SUCCESS;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;				/* ----------  end of function main  ---------- */&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Molar-Mass-ACM-ICPC-sroul-2007-UVa1586&quot;&gt;&lt;a href=&quot;#Molar-Mass-ACM-ICPC-sroul-2007-UVa1586&quot; class=&quot;headerlink&quot; title=&quot;Molar Mass ACM/I
    
    </summary>
    
    
      <category term="竞赛" scheme="http://zhangshengshan.github.io/tags/%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>Spark Streaming Programming Guide</title>
    <link href="http://zhangshengshan.github.io/2016/12/15/Spark-Streaming-Programming-Guide/"/>
    <id>http://zhangshengshan.github.io/2016/12/15/Spark-Streaming-Programming-Guide/</id>
    <published>2016-12-15T15:58:03.000Z</published>
    <updated>2016-12-16T03:52:07.000Z</updated>
    
    <content type="html"></content>
    
    <summary type="html">
    
    </summary>
    
    
      <category term="Spark Streaming" scheme="http://zhangshengshan.github.io/tags/Spark-Streaming/"/>
    
  </entry>
  
  <entry>
    <title>17年要读的书和学习的技能</title>
    <link href="http://zhangshengshan.github.io/2016/12/09/17%E5%B9%B4%E8%A6%81%E8%AF%BB%E7%9A%84%E4%B9%A6%E5%92%8C%E5%AD%A6%E4%B9%A0%E7%9A%84%E6%8A%80%E8%83%BD/"/>
    <id>http://zhangshengshan.github.io/2016/12/09/17年要读的书和学习的技能/</id>
    <published>2016-12-09T10:14:36.000Z</published>
    <updated>2016-12-09T11:54:54.000Z</updated>
    
    <content type="html">&lt;h1 id=&quot;17年要读的书&quot;&gt;&lt;a href=&quot;#17年要读的书&quot; class=&quot;headerlink&quot; title=&quot;17年要读的书&quot;&gt;&lt;/a&gt;17年要读的书&lt;/h1&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;书籍名称&lt;/th&gt;
&lt;th&gt;目的&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;算法艺术与信息学竞赛:算法竞赛入门经典(第2版)&lt;/td&gt;
&lt;td&gt;提升算法水平，强化C／C++&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;算法竞赛入门经典:训练指南&lt;/td&gt;
&lt;td&gt;提高算法，训练思维&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;自己动手写Java虚拟机&lt;/td&gt;
&lt;td&gt;了解JAVA虚拟机原理，提升Golang编程水平&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;响应式架构:消息模式Actor实现与Scala、Akka应用集成&lt;/td&gt;
&lt;td&gt;学习并发编程、提升Scala编程水平&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href=&quot;https://github.com/exacity/deeplearningbook-chinese&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;深度学习中文版&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;学习深度学习，为该项目贡献代码&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;分布式实时处理系统：原理、架构与实现&lt;/td&gt;
&lt;td&gt;深入理解分布式程序开发，提升C／C++实战能力&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;深度学习：21天实战Caffe&lt;/td&gt;
&lt;td&gt;实战深度学习，提升C／C++编程水平&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&quot;17年要学习的技能&quot;&gt;&lt;a href=&quot;#17年要学习的技能&quot; class=&quot;headerlink&quot; title=&quot;17年要学习的技能&quot;&gt;&lt;/a&gt;17年要学习的技能&lt;/h1&gt;&lt;p&gt;机器学习方向&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;DecisionTree&lt;/li&gt;
&lt;li&gt;XgBoost&lt;/li&gt;
&lt;li&gt;SVM &lt;/li&gt;
&lt;li&gt;AdaBoost&lt;/li&gt;
&lt;li&gt;PCA&lt;/li&gt;
&lt;li&gt;LogisticRegresion&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Scala&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Akka&lt;/li&gt;
&lt;li&gt;Actor&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;JAVA&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Spring SpringMVC MyBatis&lt;/li&gt;
&lt;li&gt;SpringBoot&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Golang&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Beego&lt;/li&gt;
&lt;li&gt;channel基础&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;数学基础&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;线性代数&lt;/li&gt;
&lt;li&gt;概率论&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Spark&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Spark mlib&lt;/li&gt;
&lt;li&gt;streaming(redis/kafka/akka/hbase)&lt;/li&gt;
&lt;li&gt;structure streaming&lt;/li&gt;
&lt;li&gt;basic rdd&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;17年要读的书&quot;&gt;&lt;a href=&quot;#17年要读的书&quot; class=&quot;headerlink&quot; title=&quot;17年要读的书&quot;&gt;&lt;/a&gt;17年要读的书&lt;/h1&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;书籍名称&lt;/th&gt;
&lt;th&gt;目的&lt;/th&gt;
&lt;/tr&gt;

    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>SparkDataFrameLikeSql</title>
    <link href="http://zhangshengshan.github.io/2016/12/09/SparkDataFrameLikeSql/"/>
    <id>http://zhangshengshan.github.io/2016/12/09/SparkDataFrameLikeSql/</id>
    <published>2016-12-09T08:11:00.000Z</published>
    <updated>2016-12-15T04:11:24.000Z</updated>
    
    <content type="html">&lt;p&gt;The idea of spark Datafame may be inspired from dataframe of pandas which is a package of python for structure data processing. On my opinion, dataframe can by prefered by the people with BI(business intelligence) background for high development efficiency.&lt;/p&gt;
&lt;p&gt;DataFrame in Spark could by registered as something which could be considered approximately as a virtual table, therefore anyone who has expierence of SQL could explore the data at quite a low cost of time.&lt;/p&gt;
&lt;p&gt;This article will focus on some dataframe processing method without the help of registering a virtual table and executing SQL, however the corresponding SQL operations such as  SELECT, WHERE, GROUPBY, MIN, MAX, COUNT, SUM ,DISTINCT, ORDERBY, DESC/ASC, JOIN and GROUPBY TOP will be supplied for a better understanding of dataframe in spark.&lt;/p&gt;
&lt;h2 id=&quot;prepare-test-data&quot;&gt;&lt;a href=&quot;#prepare-test-data&quot; class=&quot;headerlink&quot; title=&quot;prepare test data&quot;&gt;&lt;/a&gt;prepare test data&lt;/h2&gt;&lt;p&gt;Firstly we make a DataFrame object a by reading a json file&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;val sc: SparkContext // An existing SparkContext.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;val sqlContext = new org.apache.spark.sql.SQLContext(sc)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;// this is used to implicitly convert an RDD to a DataFrame.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import sqlContext.implicits._&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;val a = sqlContext.read.json(&amp;quot;people.json&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;and the content of people.json is as below&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&amp;quot;name&amp;quot;:&amp;quot;Michael&amp;quot; , &amp;quot;age&amp;quot;:23 ,&amp;quot;depart&amp;quot;:&amp;quot;A&amp;quot;,&amp;quot;salary&amp;quot;:3000 &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&amp;quot;name&amp;quot;:&amp;quot;Dan&amp;quot;     , &amp;quot;age&amp;quot;:23 ,&amp;quot;depart&amp;quot;:&amp;quot;A&amp;quot;,&amp;quot;salary&amp;quot;:3500 &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&amp;quot;name&amp;quot;:&amp;quot;Alex&amp;quot;    , &amp;quot;age&amp;quot;:23 ,&amp;quot;depart&amp;quot;:&amp;quot;A&amp;quot;,&amp;quot;salary&amp;quot;:3600 &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&amp;quot;name&amp;quot;:&amp;quot;Ben&amp;quot;     , &amp;quot;age&amp;quot;:23 ,&amp;quot;depart&amp;quot;:&amp;quot;A&amp;quot;,&amp;quot;salary&amp;quot;:3700 &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&amp;quot;name&amp;quot;:&amp;quot;Andy&amp;quot;    , &amp;quot;age&amp;quot;:30 ,&amp;quot;depart&amp;quot;:&amp;quot;B&amp;quot;,&amp;quot;salary&amp;quot;:4000 &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&amp;quot;name&amp;quot;:&amp;quot;Justin&amp;quot;  , &amp;quot;age&amp;quot;:19 ,&amp;quot;depart&amp;quot;:&amp;quot;A&amp;quot;,&amp;quot;salary&amp;quot;:5000 &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&amp;quot;name&amp;quot;:&amp;quot;Jack&amp;quot;    , &amp;quot;age&amp;quot;:19 ,&amp;quot;depart&amp;quot;:&amp;quot;B&amp;quot;,&amp;quot;salary&amp;quot;:2000 &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;let us image a as a Table which is stored in a RDS database such as MySQL.&lt;/p&gt;
&lt;h2 id=&quot;desc&quot;&gt;&lt;a href=&quot;#desc&quot; class=&quot;headerlink&quot; title=&quot;desc&quot;&gt;&lt;/a&gt;desc&lt;/h2&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;desc people;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;scala&amp;gt; a.printSchema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;root&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|-- age: long (nullable = true)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|-- depart: string (nullable = true)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|-- name: string (nullable = true)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|-- salary: long (nullable = true)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;SELECT&quot;&gt;&lt;a href=&quot;#SELECT&quot; class=&quot;headerlink&quot; title=&quot;SELECT&quot;&gt;&lt;/a&gt;SELECT&lt;/h2&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;select name from people;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;a.select(&amp;quot;name&amp;quot;).show&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;a.select($&amp;quot;name&amp;quot;).show&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;a.select(a(&amp;quot;name&amp;quot;)).show&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;the three methods above are equivelent.&lt;/p&gt;
&lt;h2 id=&quot;WHERE&quot;&gt;&lt;a href=&quot;#WHERE&quot; class=&quot;headerlink&quot; title=&quot;WHERE&quot;&gt;&lt;/a&gt;WHERE&lt;/h2&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;select name,age from people where age = 23&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;a.select(&amp;quot;name&amp;quot;, &amp;quot;age&amp;quot;).where($&amp;quot;age&amp;quot;===23).show&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;a.select(&amp;quot;name&amp;quot;, &amp;quot;age&amp;quot;).filter($&amp;quot;age&amp;quot;===23).show&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;MIN-MAX-SUM-COUNT&quot;&gt;&lt;a href=&quot;#MIN-MAX-SUM-COUNT&quot; class=&quot;headerlink&quot; title=&quot;MIN,MAX,SUM,COUNT&quot;&gt;&lt;/a&gt;MIN,MAX,SUM,COUNT&lt;/h2&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;select min(age), max(age), sum(salary), count(age) from people&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;a.select(min(&amp;quot;age&amp;quot;),max(&amp;quot;age&amp;quot;),sum(&amp;quot;salary&amp;quot;),count(&amp;quot;age&amp;quot;)).show&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;a.agg(min(&amp;quot;age&amp;quot;),max(&amp;quot;age&amp;quot;),sum(&amp;quot;salary&amp;quot;),count(&amp;quot;age&amp;quot;)).show&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;and the result is&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+--------+--------+-----------+----------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|min(age)|max(age)|sum(salary)|count(age)|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+--------+--------+-----------+----------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|      19|      30|      24800|         7|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+--------+--------+-----------+----------+&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;COUNT-DISTINCT&quot;&gt;&lt;a href=&quot;#COUNT-DISTINCT&quot; class=&quot;headerlink&quot; title=&quot;COUNT DISTINCT&quot;&gt;&lt;/a&gt;COUNT DISTINCT&lt;/h2&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;select count (distinct age) , count ( distinct name ) from people&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;a.select(count(&amp;quot;age&amp;quot;),countDistinct(&amp;quot;age&amp;quot;)).show&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;a.agg(count(&amp;quot;age&amp;quot;), countDistinct(&amp;quot;name&amp;quot;)).show&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;and the result is&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;+-------------------+--------------------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|count(DISTINCT age)|count(DISTINCT name)|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+-------------------+--------------------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|                  7|                   3|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+-------------------+--------------------+&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;ORDERBY-desc&quot;&gt;&lt;a href=&quot;#ORDERBY-desc&quot; class=&quot;headerlink&quot; title=&quot;ORDERBY desc&quot;&gt;&lt;/a&gt;ORDERBY desc&lt;/h2&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;select * from people orderby age desc, name desc&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;a.sort($&amp;quot;age&amp;quot;.desc,$&amp;quot;name&amp;quot;.desc).show&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;+---+------+-------+------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|age|depart|   name|salary|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+---+------+-------+------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 30|     B|   Andy|  4000|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 23|     A|Michael|  3000|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 23|     A|    Dan|  3500|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 23|     A|    Ben|  3700|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 23|     A|   Alex|  3600|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 19|     A| Justin|  5000|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 19|     B|   Jack|  2000|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+---+------+-------+------+&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;inner-join-left-outer-join-and-convert-null-to-a-default-value&quot;&gt;&lt;a href=&quot;#inner-join-left-outer-join-and-convert-null-to-a-default-value&quot; class=&quot;headerlink&quot; title=&quot;inner join, left outer join and convert null to a default value&quot;&gt;&lt;/a&gt;inner join, left outer join and convert null to a default value&lt;/h2&gt;&lt;p&gt;first we make another dataframe based on a&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;val c = a.filter(not ($&amp;quot;age&amp;quot;===23))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;scala&amp;gt; c.show&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+---+------+------+------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|age|depart|  name|salary|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+---+------+------+------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 30|     B|  Andy|  4000|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 19|     A|Justin|  5000|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 19|     B|  Jack|  2000|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+---+------+------+------+&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;now we try to join a and c &lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;select &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    a.age as a_age,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    if(c.age is null, 0, c.age) as c_age,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    a.depart as a_depart&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;from &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    a&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;left outer join&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    c&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;on &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    a.age = c.age&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;the cording dataframe form is&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;scala&amp;gt; a.join(c,a(&amp;quot;age&amp;quot;)===c(&amp;quot;age&amp;quot;),&amp;quot;left&amp;quot;).select(a(&amp;quot;age&amp;quot;).alias(&amp;quot;a_age&amp;quot;),c(&amp;quot;age&amp;quot;).alias(&amp;quot;c_age&amp;quot;),a(&amp;quot;depart&amp;quot;).alias(&amp;quot;a_depart&amp;quot;)).na.fill(0,Seq(&amp;quot;c_age&amp;quot;)).show&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+-----+-----+--------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|a_age|c_age|a_depart|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+-----+-----+--------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|   23|    0|       A|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|   23|    0|       A|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|   23|    0|       A|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|   23|    0|       A|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|   30|   30|       B|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|   19|   19|       A|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|   19|   19|       A|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|   19|   19|       B|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|   19|   19|       B|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+-----+-----+--------+&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;what if those records whose c.age is null is execluded&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;select &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    a.age as a_age,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    if(c.age is null, 0, c.age) as c_age,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    a.depart as a_depart&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;from &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    a&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;left outer join&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    c&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;on &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    a.age = c.age&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;where &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    c.age is not null&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;the na.drop method provided this function&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;scala&amp;gt; a.join(c,a(&amp;quot;age&amp;quot;)===c(&amp;quot;age&amp;quot;),&amp;quot;left&amp;quot;).select(a(&amp;quot;age&amp;quot;).alias(&amp;quot;a_age&amp;quot;),c(&amp;quot;age&amp;quot;).alias(&amp;quot;c_age&amp;quot;),a(&amp;quot;depart&amp;quot;).alias(&amp;quot;a_depart&amp;quot;)).na.drop.show&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+-----+-----+--------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|a_age|c_age|a_depart|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+-----+-----+--------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|   30|   30|       B|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|   19|   19|       A|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|   19|   19|       A|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|   19|   19|       B|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|   19|   19|       B|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+-----+-----+--------+&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;Top-N-for-group&quot;&gt;&lt;a href=&quot;#Top-N-for-group&quot; class=&quot;headerlink&quot; title=&quot;Top N for group&quot;&gt;&lt;/a&gt;Top N for group&lt;/h2&gt;&lt;p&gt;use window operation can help&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;import org.apache.spark.sql.expressions.Window&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;val w = Window.partitionBy($&amp;quot;depart&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import org.apache.spark.sql.expressions.Window&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;val rankAsc = row_number().over(w.orderBy($&amp;quot;salary&amp;quot;)).alias(&amp;quot;rank_asc&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;val rankDesc = row_number().over(w.orderBy($&amp;quot;salary&amp;quot;.desc)).alias(&amp;quot;rank_desc&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;scala&amp;gt; a.select($&amp;quot;*&amp;quot;, rankAsc, rankDesc).filter($&amp;quot;rank_asc&amp;quot;&amp;lt;3 || $&amp;quot;rank_desc&amp;quot; &amp;gt;= 2).show&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+---+------+-------+------+--------+---------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|age|depart|   name|salary|rank_asc|rank_desc|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+---+------+-------+------+--------+---------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 30|     B|   Andy|  4000|       2|        1|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 19|     B|   Jack|  2000|       1|        2|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 23|     A|    Ben|  3700|       4|        2|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 23|     A|   Alex|  3600|       3|        3|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 23|     A|    Dan|  3500|       2|        4|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 23|     A|Michael|  3000|       1|        5|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+---+------+-------+------+--------+---------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;scala&amp;gt; a.select($&amp;quot;*&amp;quot;, rankAsc, rankDesc).filter($&amp;quot;rank_asc&amp;quot;&amp;lt;3 &amp;amp;&amp;amp; $&amp;quot;rank_desc&amp;quot; &amp;gt;= 2).show&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+---+------+-------+------+--------+---------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|age|depart|   name|salary|rank_asc|rank_desc|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+---+------+-------+------+--------+---------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 19|     B|   Jack|  2000|       1|        2|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 23|     A|    Dan|  3500|       2|        4|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| 23|     A|Michael|  3000|       1|        5|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+---+------+-------+------+--------+---------+&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;what’s more, it is clearly &lt;code&gt;select *&lt;/code&gt; in SQL could by implemented by &lt;code&gt;select($&amp;quot;*&amp;quot;)&lt;/code&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;The idea of spark Datafame may be inspired from dataframe of pandas which is a package of python for structure data processing. On my opi
    
    </summary>
    
    
      <category term="Spark DataFrame" scheme="http://zhangshengshan.github.io/tags/Spark-DataFrame/"/>
    
  </entry>
  
  <entry>
    <title>save spark rdd into Mysql</title>
    <link href="http://zhangshengshan.github.io/2016/12/05/save-spark-rdd-into-Mysql/"/>
    <id>http://zhangshengshan.github.io/2016/12/05/save-spark-rdd-into-Mysql/</id>
    <published>2016-12-05T14:12:19.000Z</published>
    <updated>2016-12-09T05:12:24.000Z</updated>
    
    <content type="html">&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;import java.util.Properties&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;val target_df = targetRdd.toDF()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;val prop = new Properties()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;prop.put(&amp;quot;user&amp;quot;, &amp;quot;username&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;prop.put(&amp;quot;password&amp;quot;, &amp;quot;password&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ret_df.write.mode(&amp;quot;append&amp;quot;).jdbc(&amp;quot;jdbc:mysql://host:port/database&amp;quot;,&amp;quot;table&amp;quot;,prop)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>SparkStreamLearning</title>
    <link href="http://zhangshengshan.github.io/2016/11/28/SparkStreamLearning/"/>
    <id>http://zhangshengshan.github.io/2016/11/28/SparkStreamLearning/</id>
    <published>2016-11-28T05:16:15.000Z</published>
    <updated>2016-11-28T05:37:32.000Z</updated>
    
    <content type="html">&lt;h1 id=&quot;input-source&quot;&gt;&lt;a href=&quot;#input-source&quot; class=&quot;headerlink&quot; title=&quot;input source&quot;&gt;&lt;/a&gt;input source&lt;/h1&gt;&lt;p&gt;kafka&lt;br&gt;akka&lt;/p&gt;
&lt;h1 id=&quot;output&quot;&gt;&lt;a href=&quot;#output&quot; class=&quot;headerlink&quot; title=&quot;output&quot;&gt;&lt;/a&gt;output&lt;/h1&gt;&lt;p&gt;redis&lt;br&gt;kafka&lt;br&gt;elasticSearch&lt;br&gt;hive&lt;br&gt;mySql&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;input-source&quot;&gt;&lt;a href=&quot;#input-source&quot; class=&quot;headerlink&quot; title=&quot;input source&quot;&gt;&lt;/a&gt;input source&lt;/h1&gt;&lt;p&gt;kafka&lt;br&gt;akka&lt;/p&gt;
&lt;h1 id=&quot;outp
    
    </summary>
    
    
      <category term="Spark Scala Streaming" scheme="http://zhangshengshan.github.io/tags/Spark-Scala-Streaming/"/>
    
  </entry>
  
  <entry>
    <title>MAC访问你DOCKER容器中的WEB页面</title>
    <link href="http://zhangshengshan.github.io/2016/11/10/MAC%E8%AE%BF%E9%97%AE%E4%BD%A0DOCKER%E5%AE%B9%E5%99%A8%E4%B8%AD%E7%9A%84WEB%E9%A1%B5%E9%9D%A2/"/>
    <id>http://zhangshengshan.github.io/2016/11/10/MAC访问你DOCKER容器中的WEB页面/</id>
    <published>2016-11-10T15:22:16.000Z</published>
    <updated>2016-11-10T16:00:18.000Z</updated>
    
    <content type="html">&lt;p&gt;docker run -d -p hostport:dockerport –name your_container_name  your_image_name nginx -g “daemon off;”&lt;/p&gt;
&lt;p&gt;the above instruction start a docker nginx application which bind is port dockerport to its host port hostport.&lt;br&gt;usually you can access the nginx service on your host environment by curl the hostport, however in MacOs, ths hostport here&lt;br&gt;is the virtual machine. so when you curl localhost:hostport, you will get no response.&lt;/p&gt;
&lt;p&gt;the right way is access the virtual machine responding port. so the ip of virtual machine is needed.&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;docker-machine ip your_virtual_machine&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;curl the ip you get:hostport&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;docker run -d -p hostport:dockerport –name your_container_name  your_image_name nginx -g “daemon off;”&lt;/p&gt;
&lt;p&gt;the above instruction start
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Install Caffe on CentOS</title>
    <link href="http://zhangshengshan.github.io/2016/11/09/Install-Caffe-on-CentOS/"/>
    <id>http://zhangshengshan.github.io/2016/11/09/Install-Caffe-on-CentOS/</id>
    <published>2016-11-09T08:07:49.000Z</published>
    <updated>2016-11-14T09:13:20.000Z</updated>
    
    <content type="html">&lt;p&gt;尽量不要在CentOS平台上安装Caffe&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;尽量不要在CentOS平台上安装Caffe&lt;/p&gt;

    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Spark Window Operation </title>
    <link href="http://zhangshengshan.github.io/2016/08/22/Spark-Window-Operation/"/>
    <id>http://zhangshengshan.github.io/2016/08/22/Spark-Window-Operation/</id>
    <published>2016-08-22T06:39:58.000Z</published>
    <updated>2016-11-10T16:00:16.000Z</updated>
    
    <content type="html"></content>
    
    <summary type="html">
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Spark 2.0 Introduction</title>
    <link href="http://zhangshengshan.github.io/2016/08/19/Spark-2-0-Introduction/"/>
    <id>http://zhangshengshan.github.io/2016/08/19/Spark-2-0-Introduction/</id>
    <published>2016-08-19T10:04:07.000Z</published>
    <updated>2016-11-10T16:00:16.000Z</updated>
    
    <content type="html">&lt;h1 id=&quot;Spark-2-0-MLib-Introduction&quot;&gt;&lt;a href=&quot;#Spark-2-0-MLib-Introduction&quot; class=&quot;headerlink&quot; title=&quot;Spark 2.0 MLib Introduction&quot;&gt;&lt;/a&gt;Spark 2.0 MLib Introduction&lt;/h1&gt;&lt;p&gt;As of Spark 2.0, the RDD-based APIs in the spark.mllib package have entered maintenance mode. The primary Machine Learning API for Spark is now the DataFrame-based API in the spark.ml package.&lt;/p&gt;
&lt;p&gt;Spark2.0 ,在spark.mllib中的基于RDD的机器学习APIs将会进入维护模式。现在机器学习的主要的API基于DataFrame,位于spark.ml中。&lt;/p&gt;
&lt;p&gt;What are the implications?&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;MLlib will still support the RDD-based API in spark.mllib with bug fixes.
MLlib will not add new features to the RDD-based API.
In the Spark 2.x releases, MLlib will add features to the DataFrames-based API to reach feature parity with the RDD-based API.
After reaching feature parity (roughly estimated for Spark 2.2), the RDD-based API will be deprecated.
The RDD-based API is expected to be removed in Spark 3.0.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Why is MLlib switching to the DataFrame-based API?&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;DataFrames provide a more user-friendly API than RDDs. The many benefits of DataFrames include Spark Datasources, SQL/DataFrame queries, Tungsten and Catalyst optimizations, and uniform APIs across languages.
The DataFrame-based API for MLlib provides a uniform API across ML algorithms and across multiple languages.
DataFrames facilitate practical ML Pipelines, particularly feature transformations. See the Pipelines guide for details.
&lt;/code&gt;&lt;/pre&gt;</content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Spark-2-0-MLib-Introduction&quot;&gt;&lt;a href=&quot;#Spark-2-0-MLib-Introduction&quot; class=&quot;headerlink&quot; title=&quot;Spark 2.0 MLib Introduction&quot;&gt;&lt;/a&gt;Spark
    
    </summary>
    
    
      <category term="Spark" scheme="http://zhangshengshan.github.io/tags/Spark/"/>
    
  </entry>
  
  <entry>
    <title>Save DataFrame into a partitioned table of HIVE</title>
    <link href="http://zhangshengshan.github.io/2016/08/19/Save-DataFrame-into-a-partitioned-table-of-HIVE/"/>
    <id>http://zhangshengshan.github.io/2016/08/19/Save-DataFrame-into-a-partitioned-table-of-HIVE/</id>
    <published>2016-08-19T09:15:15.000Z</published>
    <updated>2016-11-10T16:00:16.000Z</updated>
    
    <content type="html">&lt;h1 id=&quot;How-to-save-a-spark-DataFrame-as-a-patitioned-hive-table&quot;&gt;&lt;a href=&quot;#How-to-save-a-spark-DataFrame-as-a-patitioned-hive-table&quot; class=&quot;headerlink&quot; title=&quot;How to save a spark DataFrame as a patitioned hive table&quot;&gt;&lt;/a&gt;How to save a spark DataFrame as a patitioned hive table&lt;/h1&gt;&lt;h2 id=&quot;utilise-saveAsTable-method&quot;&gt;&lt;a href=&quot;#utilise-saveAsTable-method&quot; class=&quot;headerlink&quot; title=&quot;utilise saveAsTable method&quot;&gt;&lt;/a&gt;utilise saveAsTable method&lt;/h2&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;val conf = new SparkConf().setAppName(&amp;quot;Simple Application&amp;quot;).setMaster(&amp;quot;local&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;val sc = new SparkContext(conf)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;val sqlContext = new org.apache.spark.sql.SQLContext(sc)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import sqlContext.implicits._&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;val hiveContext = new org.apache.spark.sql.hive.HiveContext(sc)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;hiveContext.sql(&amp;quot;use database&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;val cmd =&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     select&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      col1,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      col2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     from&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      table&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;quot;&amp;quot;&amp;quot;.stripMargin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;val yourDf = hiveContext.sql(cmd)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;yourDf.printSchema()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;yourDf.write.partitionBy(&amp;quot;col2&amp;quot;).saveAsTable(&amp;quot;partitionTableName&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;How-to-save-a-spark-DataFrame-as-a-patitioned-hive-table&quot;&gt;&lt;a href=&quot;#How-to-save-a-spark-DataFrame-as-a-patitioned-hive-table&quot; class=
    
    </summary>
    
    
      <category term="Spark" scheme="http://zhangshengshan.github.io/tags/Spark/"/>
    
  </entry>
  
  <entry>
    <title>SparkPassFunctions</title>
    <link href="http://zhangshengshan.github.io/2016/08/11/SparkPassFunctions/"/>
    <id>http://zhangshengshan.github.io/2016/08/11/SparkPassFunctions/</id>
    <published>2016-08-11T07:19:37.000Z</published>
    <updated>2016-11-10T16:00:16.000Z</updated>
    
    <content type="html">&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;class MyClass &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  val field = &amp;quot;Hello&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  def doStuff(rdd: RDD[String]): RDD[String] = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  val field_ = this.field&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  rdd.map(x =&amp;gt; field_ + x)&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class
    
    </summary>
    
    
      <category term="Spark" scheme="http://zhangshengshan.github.io/tags/Spark/"/>
    
  </entry>
  
  <entry>
    <title>MergeSort</title>
    <link href="http://zhangshengshan.github.io/2016/07/26/MergeSort/"/>
    <id>http://zhangshengshan.github.io/2016/07/26/MergeSort/</id>
    <published>2016-07-26T12:30:03.000Z</published>
    <updated>2016-11-10T16:00:14.000Z</updated>
    
    <content type="html">&lt;p&gt;归并排序&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;def msort[A](less: (A, A) =&amp;gt; Boolean)(xs: List[A]): List[A] = &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    def merge(xs1: List[A], xs2: List[A]): List[A] =&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        if (xs1.isEmpty) xs2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        else if (xs2.isEmpty) xs1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        else if (less(xs1.head, xs2.head)) xs1.head :: merge(xs1.tail, xs2) else xs2.head :: merge(xs1, xs2.tail)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    val n = xs.length/2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    if (n == 0) xs&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    else merge(msort(less)(xs take n), msort(less)(xs drop n))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;如果你对python列表的用法比较熟悉的话，可以按照如下的方式理解&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;xs take n   // xs[0:n+1]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;xs drop n   // xs[n+1:]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;msort函数应该按照如下方式进行调用&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;msort((x: Int, y: Int) =&amp;gt; x &amp;lt; y)(List(5, 7, 1, 3))&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;归并排序&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br
    
    </summary>
    
    
      <category term="Scala" scheme="http://zhangshengshan.github.io/tags/Scala/"/>
    
  </entry>
  
  <entry>
    <title>ScalaList</title>
    <link href="http://zhangshengshan.github.io/2016/07/26/ScalaList/"/>
    <id>http://zhangshengshan.github.io/2016/07/26/ScalaList/</id>
    <published>2016-07-26T05:11:12.000Z</published>
    <updated>2016-11-10T16:00:14.000Z</updated>
    
    <content type="html">&lt;p&gt;Lists are not built in in Scala; they are defined by an abstract class List, &lt;strong&gt;which comes with two subclasses for :: and Nil.&lt;/strong&gt;&lt;br&gt;List 并不是Scala的内置类型。List被定义为抽象类。&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;package scala&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;abstract class List[+A] &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;List is an abstract class, so one cannot define elements by calling the empty List constructor (e.g. by new List). The class has a type parameter a. It is co-variant in this parameter,which means thatList[S] &amp;lt;: List[T] for all types S and T such thatS &amp;lt;: T.The class is situated in the package scala.This is a package containing the most important standard classes of Scala. List defines a number of methods, which are explained in the following.&lt;br&gt;List 是抽象类，所以没有办法通过空的List构造器来定义元素。List存在一个类型参数A。该参数是协变类型, 对于任意类型S和T，如果S&amp;lt;:T, 则 List[S]&amp;lt;:List[T]。该类的定义在scala package中。这个包是Scala中最重要的标准calsses。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;Lists are not built in in Scala; they are defined by an abstract class List, &lt;strong&gt;which comes with two subclasses for :: and Nil.&lt;/str
    
    </summary>
    
    
      <category term="Scala" scheme="http://zhangshengshan.github.io/tags/Scala/"/>
    
  </entry>
  
</feed>
